<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>–°–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –°–∏—Å—Ç–µ–º–∞ —É—á—ë—Ç–∞</title>
    <style>
:root {
    --primary-color: #667eea;
    --primary-dark: #764ba2;
    --secondary-color: #f093fb;
    --accent-color: #4facfe;
    --success-color: #43e97b;
    --error-color: #fa709a;
    --bg-dark: #0a0e27;
    --bg-darker: #1a1f3a;
    --bg-container: rgba(10, 14, 39, 0.85);
    --text-primary: #f0f4ff;
    --text-secondary: #c8d2e8;
    --border-color: rgba(135, 150, 200, 0.15);
    --touch-target: 44px;
}
body {
    background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #2d1b3d 100%);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    color: var(--text-primary);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    min-height: 100vh;
    padding: 10px;
    -webkit-font-smoothing: antialiased;
    touch-action: manipulation;
}
@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}
.container {
    background: rgba(10, 14, 39, 0.75);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(135, 150, 200, 0.2);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(102, 126, 234, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
    border-radius: 16px;
    padding: 20px;
}
.header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    background-size: 200% 200%;
    animation: gradientFlow 8s ease infinite;
    border-bottom: 1px solid rgba(135, 150, 200, 0.2);
    box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
    padding: 16px 20px;
    margin-bottom: 20px;
}
@keyframes gradientFlow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}
.header-inner {
    display: flex;
    align-items: center;
    gap: 12px;
}
.logo {
    height: 40px;
    width: auto;
    filter: drop-shadow(0 2px 8px rgba(102, 126, 234, .45));
    transition: transform 0.3s ease;
}
.logo:hover {
    transform: scale(1.05);
}
h1 {
    color: #ffffff;
    text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3);
    margin: 0;
    font-size: clamp(18px, 4vw, 24px);
}
.subtitle {
    color: rgba(255, 255, 255, 0.85);
    margin: 0;
    font-size: clamp(12px, 3vw, 14px);
}
.section {
    padding: 20px;
    display: none;
    animation: fadeIn 0.3s ease-in;
}
.section.active {
    display: block;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
.warehouse-btn {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(240, 147, 251, 0.3) 100%);
    border: 1px solid rgba(135, 150, 200, 0.3);
    color: #f0f4ff;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
    padding: 16px;
    border-radius: 12px;
    cursor: pointer;
    text-align: center;
    font-size: clamp(12px, 2.5vw, 13px);
    font-weight: 500;
    min-height: var(--touch-target);
    word-break: break-word;
    margin: 8px 0;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}
.warehouse-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg,
        transparent,
        rgba(102, 126, 234, 0.4),
        rgba(240, 147, 251, 0.4),
        transparent);
    transition: left 0.6s ease;
}
.warehouse-btn:hover::before {
    left: 100%;
}
.warehouse-btn:active {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.5) 0%, rgba(240, 147, 251, 0.5) 100%);
    box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
}
button {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    background-size: 200% 200%;
    color: #ffffff;
    border: none;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4),
                0 2px 5px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    padding: 14px 24px;
    border-radius: 8px;
    cursor: pointer;
    margin: 5px;
    font-size: clamp(14px, 3vw, 16px);
    font-weight: 500;
    min-height: var(--touch-target);
}
button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg,
        transparent,
        rgba(255, 255, 255, 0.3),
        transparent);
    transition: left 0.5s ease;
}
button:hover {
    background-position: 100% 50%;
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5),
                0 3px 8px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
}
button:hover::before {
    left: 100%;
}
button:active {
    transform: scale(0.98);
    box-shadow: 0 2px 10px rgba(102, 126, 234, 0.4),
                inset 0 2px 5px rgba(0, 0, 0, 0.3);
}
button.secondary {
    background: linear-gradient(135deg, rgba(79, 172, 254, 0.3) 0%, rgba(102, 126, 234, 0.3) 100%);
    border: 1px solid rgba(135, 150, 200, 0.3);
    box-shadow: 0 4px 15px rgba(79, 172, 254, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
}
button.secondary:hover {
    background: linear-gradient(135deg, rgba(79, 172, 254, 0.5) 0%, rgba(102, 126, 234, 0.5) 100%);
    box-shadow: 0 6px 20px rgba(79, 172, 254, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
}
.large-button {
    width: 100%;
    padding: 18px 40px;
    font-size: clamp(16px, 4vw, 18px);
    font-weight: 600;
    min-height: 52px;
}
.calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 3px;
    margin: 15px 0;
    padding: 10px;
    border-radius: 12px;
    background: rgba(30, 35, 60, 0.4);
    border: 1px solid rgba(135, 150, 200, 0.15);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.2),
                0 1px 0 rgba(255, 255, 255, 0.05);
}
.calendar-header {
    text-align: center;
    font-weight: 600;
    padding: 6px 2px;
    border-radius: 6px;
    font-size: clamp(9px, 2vw, 11px);
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(240, 147, 251, 0.2) 100%);
    color: #d0dcff;
    border: 1px solid rgba(135, 150, 200, 0.1);
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.1);
}
button.date-btn {
    padding: 8px 4px;
    font-size: clamp(11px, 2.2vw, 13px);
    min-height: 36px;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    background: rgba(51, 65, 85, 0.4);
    border: 1px solid rgba(135, 150, 200, 0.2);
    color: #c8d2e8;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.2);
    transition: all 0.2s ease;
}
button.date-btn:hover {
    background: rgba(79, 172, 254, 0.3);
    border-color: rgba(102, 126, 234, 0.5);
    box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
}
button.date-btn:active,
button.date-btn.selected {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #ffffff;
    border-color: #f093fb;
    box-shadow: 0 0 15px rgba(102, 126, 234, 0.6),
                inset 0 1px 2px rgba(255, 255, 255, 0.2);
}
.selected-date-display {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(240, 147, 251, 0.2) 100%);
    border: 1px solid rgba(102, 126, 234, 0.3);
    color: #d0dcff;
    box-shadow: 0 0 15px rgba(102, 126, 234, 0.2),
                inset 0 1px 2px rgba(255, 255, 255, 0.1);
    padding: 12px 20px;
    border-radius: 8px;
    margin: 15px 0;
    text-align: center;
    font-weight: 500;
    font-size: clamp(14px, 3vw, 16px);
}
.filter-section {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(240, 147, 251, 0.1) 100%);
    border: 1px solid rgba(135, 150, 200, 0.2);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.15),
                0 1px 0 rgba(255, 255, 255, 0.05);
    padding: 16px;
    border-radius: 12px;
    margin-bottom: 20px;
}
.filter-section h4 {
    color: #a8b8ff;
    text-shadow: 0 1px 3px rgba(102, 126, 234, 0.3);
    margin-bottom: 10px;
}
.date-section {
    background: linear-gradient(135deg, rgba(30, 35, 60, 0.4) 0%, rgba(45, 27, 61, 0.4) 100%);
    border: 1px solid rgba(135, 150, 200, 0.15);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.2),
                0 1px 0 rgba(255, 255, 255, 0.05);
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
}
.calendar-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    gap: 10px;
    flex-wrap: wrap;
}
.calendar-controls button {
    flex: 1;
    min-width: 100px;
    padding: 12px 16px;
    font-size: clamp(12px, 2.5vw, 14px);
}
.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 20px;
}
label {
    display: block;
    margin: 15px 0 8px;
    font-weight: 500;
    color: var(--text-secondary);
    font-size: clamp(12px, 3vw, 13px);
}
input[type="text"],
input[type="number"],
select {
    width: 100%;
    padding: 14px 16px;
    border-radius: 8px;
    font-size: 16px;
    border: 1px solid rgba(135, 150, 200, 0.25);
    background: rgba(30, 35, 60, 0.6);
    color: #f0f4ff;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2),
                0 1px 0 rgba(255, 255, 255, 0.05);
    -webkit-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg ' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23cbd5e1' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    padding-right: 40px;
}
input:focus,
select:focus {
    border-color: #667eea;
    background: rgba(30, 35, 60, 0.8);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2),
                inset 0 2px 4px rgba(0, 0, 0, 0.2);
}
.warehouse-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 12px;
    margin-bottom: 20px;
}
.radio-group {
    display: flex;
    gap: 20px;
    margin: 15px 0;
}
.radio-group label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0;
}
#console-output {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 20px);
    max-width: 600px;
    border-radius: 12px 12px 0 0;
    padding: 8px 16px;
    font-size: 11px;
    font-family: 'Courier New', monospace;
    z-index: 998;
    pointer-events: none;
    max-height: 40px;
    overflow: hidden;
    background: rgba(30, 35, 60, 0.9);
    color: #f0f4ff;
    border: 1px solid rgba(135, 150, 200, 0.3);
}
table {
    width: 100%;
    min-width: 600px;
    border-collapse: separate;
    border-spacing: 0;
    font-size: clamp(7px, 1.8vw, 10px);
    table-layout: fixed;
    transform: scale(0.95);
    transform-origin: top left;
    width: calc(100% / 0.95);
    border: 1px solid rgba(71, 85, 105, 0.3);
}
th, td {
    border: 1px solid rgba(71, 85, 105, 0.3);
    padding: 4px 3px;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.2;
}
th {
    font-size: clamp(7px, 1.8vw, 9px);
    line-height: 1.3;
    padding: 6px 4px;
    position: sticky;
    top: 0;
    font-weight: 600;
    z-index: 10;
    background: rgba(30, 35, 60, 0.7);
}
td:first-child, th:first-child {
    width: 70px;
    min-width: 70px;
    max-width: 70px;
    position: sticky;
    left: 0;
    z-index: 5;
    font-size: clamp(7px, 1.8vw, 9px);
    background: rgba(30, 35, 60, 0.7);
}
th:first-child {
    z-index: 15;
}
td:nth-child(2), th:nth-child(2) {
    width: 140px;
    min-width: 140px;
    max-width: 140px;
    position: sticky;
    left: 70px;
    z-index: 5;
    text-align: left;
    padding-left: 6px;
    font-size: clamp(7px, 1.8vw, 9px);
    background: rgba(30, 35, 60, 0.7);
}
th:nth-child(n+3), td:nth-child(n+3) {
    min-width: 35px;
    max-width: 50px;
    padding: 3px 2px;
    font-size: clamp(7px, 1.8vw, 9px);
}
.positive {
    color: #43e97b;
    font-weight: 600;
    text-shadow: 0 0 8px rgba(67, 233, 123, 0.4);
}
.negative {
    color: #fa709a;
    font-weight: 600;
    text-shadow: 0 0 8px rgba(250, 112, 154, 0.4);
}
.good {
    color: #43e97b;
    text-shadow: 0 0 5px rgba(67, 233, 123, 0.3);
}
.bad {
    color: #fa709a;
    text-shadow: 0 0 5px rgba(250, 112, 154, 0.3);
}
.summary-total {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    background-size: 200% 200%;
    animation: gradientFlow 8s ease infinite;
    color: #ffffff;
    text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
    margin-top: 20px;
    padding: 20px;
    border-radius: 12px;
    text-align: center;
    font-size: clamp(16px, 4vw, 18px);
    font-weight: 600;
}
.table-wrapper {
    border: 1px solid rgba(135, 150, 200, 0.2);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.2),
                0 1px 0 rgba(255, 255, 255, 0.05);
    overflow: auto;
    max-width: 100%;
}
.full-screen-table {
    background: rgba(10, 14, 39, 0.98);
    backdrop-filter: blur(20px);
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 1000;
    overflow: auto;
    padding: 20px;
    box-sizing: border-box;
    -webkit-overflow-scrolling: touch;
}
.close-full {
    background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    color: #ffffff;
    box-shadow: 0 10px 30px rgba(250, 112, 154, 0.5),
                0 5px 15px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
    border: none;
    padding: 14px 24px;
    cursor: pointer;
    border-radius: 8px;
    min-height: var(--touch-target);
    font-size: clamp(14px, 3vw, 16px);
    position: fixed;
    top: 20px;
    right: 20px;
}
.close-full:hover {
    box-shadow: 0 15px 40px rgba(250, 112, 154, 0.6),
                0 7px 20px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
}
.close-full:active {
    box-shadow: 0 5px 20px rgba(250, 112, 154, 0.5),
                inset 0 2px 5px rgba(0, 0, 0, 0.3);
    transform: scale(0.95);
}
@media (max-width: 768px) {
    body { padding: 8px; }
    .container { border-radius: 16px; }
    .header { padding: 16px; }
    .section { padding: 16px; }
    .warehouse-list { grid-template-columns: 1fr; gap: 10px; }
    .calendar-controls { flex-direction: column; }
    .calendar-controls button { width: 100%; }
    button { font-size: 14px; padding: 12px 20px; }
    table { font-size: 7px; transform: scale(0.9); width: calc(100% / 0.9); }
    td:first-child, th:first-child { width: 60px; min-width: 60px; max-width: 60px; }
    td:nth-child(2), th:nth-child(2) { width: 120px; min-width: 120px; max-width: 120px; left: 60px; }
    th:nth-child(n+3), td:nth-child(n+3) { min-width: 30px; max-width: 40px; padding: 2px 1px; }
    .close-full { top: 10px; right: 10px; padding: 12px 20px; }
}
@media (max-width: 480px) {
    .warehouse-btn { font-size: 12px; padding: 14px; }
    h1 { font-size: 20px; }
    h2 { font-size: 18px; }
    button { font-size: 14px; padding: 12px 20px; }
    table { font-size: 6px; transform: scale(0.85); width: calc(100% / 0.85); }
    td:first-child, th:first-child { width: 55px; min-width: 55px; max-width: 55px; }
    td:nth-child(2), th:nth-child(2) { width: 110px; min-width: 110px; max-width: 110px; left: 55px; }
}
@media (prefers-reduced-motion: reduce) {
    * {
        animation: none !important;
        transition: none !important;
    }
}
@media (min-width: 1400px) {
    .warehouse-list { grid-template-columns: repeat(3, 1fr); }
    table { font-size: 10px; transform: scale(1); width: 100%; }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-inner">
                <img src="image.png" alt="W V3LS3N" class="logo">
                <div class="header-text">
                    <h1>üìä –°–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h1>
                    <div class="subtitle">–°–∏—Å—Ç–µ–º–∞ —É—á—ë—Ç–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Å–∫–ª–∞–¥—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</div>
                </div>
            </div>
        </div>
        <div id="mainSection" class="section active">
            <h2>–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç—á—ë—Ç</h2>
            <button class="large-button" onclick="selectReport('operational')">üìÑ –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</button>
            <button class="large-button" onclick="selectReport('personnel')">üìä –ü–µ—Ä—Å–æ–Ω–∞–ª</button>
            <div class="action-buttons" style="margin-top: 20px;">
                <button class="secondary" onclick="fillTestData()">‚ö†Ô∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ–ø–µ—Ä–∞—Ü–∏–∏)</button>
                <button class="secondary" onclick="fillPersonnelTestData()">‚ö†Ô∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–µ—Ä—Å–æ–Ω–∞–ª)</button>
            </div>
        </div>
        <div id="warehouseReportSection" class="section">
            <h2 id="warehouseTitle">–û—Ç—á—ë—Ç –ø–æ —Å–∫–ª–∞–¥—É</h2>
            <div class="warehouse-list" id="warehouseList"></div>
            <div class="date-section">
                <h3>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h3>
                <div class="calendar-controls">
                    <button class="secondary" onclick="prevPeriod()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
                    <button class="secondary" onclick="toggleCalendarView()">
                        <span id="warehouseViewToggleText">üìÖ –ù–µ–¥–µ–ª—è</span>
                    </button>
                    <button class="secondary" onclick="nextPeriod()">–°–ª–µ–¥—É—é—â–∏–π ‚Üí</button>
                </div>
                <div id="warehouseCalendar" class="calendar"></div>
                <div id="selectedWarehouseDate" class="selected-date-display"></div>
            </div>
            <div class="radio-group">
                <label><input type="radio" name="warehouseReportType" value="day" checked> ‚òÄÔ∏è –î–Ω–µ–≤–Ω–∞—è —Å–º–µ–Ω–∞</label>
                <label><input type="radio" name="warehouseReportType" value="night"> üåô –ù–æ—á–Ω–∞—è —Å–º–µ–Ω–∞</label>
            </div>
            <form id="reportForm">
                <div id="categoryInputs"></div>
                <div class="action-buttons">
                    <button type="button" onclick="saveWarehouseReport()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç—á—ë—Ç</button>
                    <button class="secondary" onclick="backToMain()">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –æ—Ç—á—ë—Ç–∞</button>
                </div>
            </form>
        </div>
        <div id="personnelReportSection" class="section">
            <h2 id="personnelTitle">–û—Ç—á—ë—Ç –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É</h2>
            <div class="warehouse-list" id="personnelList"></div>
            <div class="date-section">
                <h3>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h3>
                <div class="calendar-controls">
                    <button class="secondary" onclick="prevPeriodPersonnel()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
                    <button class="secondary" onclick="toggleCalendarViewPersonnel()">
                        <span id="personnelViewToggleText">üìÖ –ù–µ–¥–µ–ª—è</span>
                    </button>
                    <button class="secondary" onclick="nextPeriodPersonnel()">–°–ª–µ–¥—É—é—â–∏–π ‚Üí</button>
                </div>
                <div id="personnelCalendar" class="calendar"></div>
                <div id="selectedPersonnelDate" class="selected-date-display"></div>
            </div>
            <div class="radio-group">
                <label><input type="radio" name="personnelReportType" value="day" checked> ‚òÄÔ∏è –î–Ω–µ–≤–Ω–∞—è —Å–º–µ–Ω–∞</label>
                <label><input type="radio" name="personnelReportType" value="night"> üåô –ù–æ—á–Ω–∞—è —Å–º–µ–Ω–∞</label>
            </div>
            <form id="personnelReportForm">
                <div id="personnelCategoryInputs"></div>
                <div class="action-buttons">
                    <button type="button" onclick="savePersonnelReport()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç—á—ë—Ç</button>
                    <button class="secondary" onclick="backToMain()">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –æ—Ç—á—ë—Ç–∞</button>
                </div>
            </form>
        </div>
        <div id="summarySection" class="section">
            <h2>üìä –û–±—â–∏–π —Å–≤–æ–¥ –ø–æ –≤—Å–µ–º —Å–∫–ª–∞–¥–∞–º</h2>
            <div class="checkbox-group">
                <label><input type="checkbox" id="summaryDay" checked> ‚òÄÔ∏è –î–Ω–µ–≤–Ω—ã–µ —Å–º–µ–Ω—ã</label>
                <label><input type="checkbox" id="summaryNight"> üåô –ù–æ—á–Ω—ã–µ —Å–º–µ–Ω—ã</label>
            </div>
            <div class="filter-section">
                <h4>üë§ –§–∏–ª—å—Ç—Ä –ø–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—é</h4>
                <select id="managerFilter" onchange="updateSummaryTable()">
                    <option value="">–í—Å–µ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏</option>
                    <option value="–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.">–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.</option>
                    <option value="–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.">–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.</option>
                </select>
            </div>
            <div class="date-section">
                <h3>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h3>
                <div class="calendar-controls">
                    <button class="secondary" onclick="prevPeriodSummary()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å</button>
                    <button class="secondary" onclick="toggleCalendarViewSummary()">
                        <span id="summaryViewToggleText">üìÜ –ú–µ—Å—è—Ü</span>
                    </button>
                    <button class="secondary" onclick="nextPeriodSummary()">–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å ‚Üí</button>
                </div>
                <div id="summaryCalendar" class="calendar"></div>
            </div>
            <div class="action-buttons">
                <button onclick="showSummaryData()">üìà –ü–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
                <button class="secondary" onclick="backToMain()">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –æ—Ç—á—ë—Ç–∞</button>
            </div>
        </div>
        <div id="summaryTableSection" class="section">
            <h2>üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞</h2>
            <div class="date-section">
                <div style="display:flex;flex-direction:column;gap:10px">
                    <button class="secondary" onclick="prevSummaryDay()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å</button>
                    <div style="text-align:center;font-size:clamp(16px,4vw,18px);font-weight:600;color:#c7d2fe;padding:10px" id="currentSummaryDate"></div>
                    <button class="secondary" onclick="nextSummaryDay()">–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å ‚Üí</button>
                </div>
            </div>
            <div id="summaryTable"></div>
            <div class="action-buttons">
                <button onclick="toggleFullScreen()">üñ•Ô∏è –ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω</button>
                <button class="secondary" onclick="showSummarySection()">‚Üê –ù–∞–∑–∞–¥</button>
            </div>
        </div>
        <div id="personnelSummarySection" class="section">
            <h2>üìä –°–≤–æ–¥ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É</h2>
            <div class="checkbox-group">
                <label><input type="checkbox" id="personnelSummaryDay" checked> ‚òÄÔ∏è –î–Ω–µ–≤–Ω—ã–µ —Å–º–µ–Ω—ã</label>
                <label><input type="checkbox" id="personnelSummaryNight"> üåô –ù–æ—á–Ω—ã–µ —Å–º–µ–Ω—ã</label>
            </div>
            <div class="filter-section">
                <h4>üë§ –§–∏–ª—å—Ç—Ä –ø–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—é</h4>
                <select id="personnelManagerFilter" onchange="updatePersonnelSummaryTable()">
                    <option value="">–í—Å–µ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏</option>
                    <option value="–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.">–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.</option>
                    <option value="–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.">–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.</option>
                </select>
            </div>
            <div class="date-section">
                <h3>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h3>
                <div class="calendar-controls">
                    <button class="secondary" onclick="prevPersonnelSummaryDay()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å</button>
                    <button class="secondary" onclick="toggleCalendarViewPersonnelSummary()">
                        <span id="personnelSummaryViewToggleText">üìÜ –ú–µ—Å—è—Ü</span>
                    </button>
                    <button class="secondary" onclick="nextPersonnelSummaryDay()">–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å ‚Üí</button>
                </div>
                <div id="personnelSummaryCalendar" class="calendar"></div>
            </div>
            <div class="action-buttons">
                <button onclick="showPersonnelSummaryData()">üìà –ü–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
                <button class="secondary" onclick="backToMain()">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –æ—Ç—á—ë—Ç–∞</button>
            </div>
        </div>
        <div id="personnelSummaryTableSection" class="section">
            <h2>üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É</h2>
            <div class="date-section">
                <div style="display:flex;flex-direction:column;gap:10px">
                    <button class="secondary" onclick="prevPersonnelSummaryDay()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å</button>
                    <div style="text-align:center;font-size:clamp(16px,4vw,18px);font-weight:600;color:#c7d2fe;padding:10px" id="currentPersonnelSummaryDate"></div>
                    <button class="secondary" onclick="nextPersonnelSummaryDay()">–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å ‚Üí</button>
                </div>
            </div>
            <div id="personnelSummaryTable"></div>
            <div class="action-buttons">
                <button onclick="togglePersonnelFullScreen()">üñ•Ô∏è –ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω</button>
                <button class="secondary" onclick="showPersonnelSummarySection()">‚Üê –ù–∞–∑–∞–¥</button>
            </div>
        </div>
        <div id="fullScreenTable" class="full-screen-table" style="display:none">
            <button class="close-full" onclick="toggleFullScreen()">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
            <div id="fullSummaryTable"></div>
        </div>
        <div id="personnelFullScreenTable" class="full-screen-table" style="display:none">
            <button class="close-full" onclick="togglePersonnelFullScreen()">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
            <div id="fullPersonnelSummaryTable"></div>
        </div>
        <div id="console-output"></div>
    </div>
    <script>
        const WAREHOUSES = [
            "–ê–†–•–ê–ù–ì–ï–õ–¨–°–ö_–•–ê–ë_–ù–ê–•–ò–ú–û–í–ê",
            "–ú–£–†–ú–ê–ù–°–ö_–•–ê–ë_–û–ë–™–ï–ó–î–ù–ê–Ø",
            "–í–ï–õ–ò–ö–ò–ô_–ù–û–í–ì–û–†–û–î_–•–ê–ë_–ù–ï–•–ò–ù–°–ö–ê–Ø",
            "–ü–ï–¢–†–û–ó–ê–í–û–î–°–ö_–•–ê–ë_–ü–†–Ø–ñ–ò–ù–°–ö–û–ï",
            "–ü–°–ö–û–í_–•–ê–ë_–ú–ê–†–ì–ï–õ–û–í–ê",
            "–ü–°–ö–û–í_–•–ê–ë_–ù–û–í–´–ô",
            "–°–´–ö–¢–´–í–ö–ê–†_–•–ê–ë_–õ–ï–°–û–ü–ê–†–ö–û–í–ê–Ø",
            "–°–´–ö–¢–´–í–ö–ê–†_–•–ê–ë_–û–ö–¢–Ø–ë–†–¨–°–ö–ò–ô",
            "–ß–ï–†–ï–ü–û–í–ï–¶_–•–ê–ë_–°–¢–†–û–ô–ò–ù–î–£–°–¢–†–ò–ò",
            "–í–û–õ–û–ì–î–ê_–•–ê–ë_–ë–ï–õ–û–ó–ï–†–°–ö–û–ï"
        ];
        const CATEGORIES = [
            {name: '–û–±—Ä–∞–±–æ—Ç–∫–∞', type: 'number'},
            {name: '–ü–µ—Ä—Å–æ–Ω–∞–ª', type: 'number'},
            {name: '–û–∫–æ–Ω—á–∞–Ω–∏–µ –≤—ã–¥–∞—á–∏', type: 'time'},
            {name: '–û–±—Ä–∞–±–æ—Ç–∫–∞ FBS', type: 'number'},
            {name: '–í–æ–∑–≤—Ä–∞—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ (–ë—ç–∫–ª–æ–≥)', type: 'number'},
            {name: '–û–±–µ–∑–ª–∏—á–∫–∞', type: 'single', label: '–ü–æ–¥–¥–æ–Ω—ã', unit: '—à—Ç'},
            {name: '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', type: 'number'},
            {name: '–ö–æ–ª-–≤–æ –ø–∞–ª–ª–µ—Ç–∞-–º–µ—Å—Ç –∫ –æ—Ç–≥—Ä—É–∑–∫–µ', type: 'triple',
             fields: [{n: 'FBS', u: '—à—Ç'}, {n: 'X-Dock', u: '—à—Ç'}, {n: '–í–æ–∑–≤—Ä–∞—Ç—ã', u: '—à—Ç'}]},
            {name: '–•—Ä–æ–Ω—å –•–î', type: 'double',
             fields: [{n: '–°–æ—Ä—Ç', u: '—à—Ç'}, {n: '–ù–æ–Ω-–°–æ—Ä—Ç', u: '—à—Ç'}]},
            {name: '–†–∏—Å–∫–∏', type: 'yesno'},
            {name: '–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –í—ã–¥–∞—á–∞', type: 'single', label: '–ó–Ω–∞—á–µ–Ω–∏–µ', unit: '—à—Ç'},
            {name: '% –Ω–µ –ø—Ä–æ—Ñ–∏–ª—è', type: 'single', label: '–ü—Ä–æ—Ü–µ–Ω—Ç', unit: '%'},
            {name: '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å', type: 'select', options: ['–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.', '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.']}
        ];
        const PERSONNEL_OBJECTS = WAREHOUSES;
        const PERSONNEL_CATEGORIES = [
            { name: '–®—Ç–∞—Ç', type: 'triple', fields: [{ n: '–ü–ª–∞–Ω', u: '' }, { n: '–§–∞–∫—Ç', u: '' }, { n: '–î–µ–ª—å—Ç–∞', u: '' }] },
            { name: 'Ozon Job', type: 'quadruple', fields: [{ n: '–ü–ª–∞–Ω', u: '' }, { n: '–§–∞–∫—Ç', u: '' }, { n: '–ö–∞–ø–∞—Å–∏—Ç–µ—Ç', u: '' }, { n: '–î–æ–ª—è OJ%', u: '%' }] },
            { name: '–†–í', type: 'single', label: '–†–í', unit: '' },
            { name: '–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞', type: 'single', label: '–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞', unit: '' },
            { name: 'Total', type: 'triple', fields: [{ n: '–ü–ª–∞–Ω', u: '' }, { n: '–§–∞–∫—Ç', u: '' }, { n: '–î–µ–ª—å—Ç–∞', u: '' }] },
            { name: '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', type: 'single', label: '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', unit: '' },
            { name: '–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞', type: 'triple', fields: [{ n: '–û–¢', u: '' }, { n: '–ë–õ', u: '' }, { n: '–ù–ù', u: '' }] },
            { name: '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏', type: 'single', label: '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏', unit: '' },
            { name: '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å', type: 'select', options: ['–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.', '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.'] }
        ];
        let reports = JSON.parse(localStorage.getItem('warehouseReports')) || {};
        let personnelReports = JSON.parse(localStorage.getItem('personnelReports')) || {};
        let currentDate = new Date();
        let warehouseCalendarView = 'week';
        let personnelCalendarView = 'week';
        let summaryCalendarView = 'month';
        let personnelSummaryCalendarView = 'month';
        let selectedWarehouseDate = null;
        let selectedPersonnelDate = null;
        let selectedSummaryDate = null;
        let selectedPersonnelSummaryDate = null;
        let currentWarehouse = '';
        let currentPersonnelObj = '';
        function cleanOldReports() {
            const sixMonthsAgo = new Date();
            sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);
            const keysToDelete = [];
            Object.keys(reports).forEach(dateStr => {
                try {
                    const [day, month, year] = dateStr.split('.').map(Number);
                    const reportDate = new Date(year, month - 1, day);
                    if (reportDate < sixMonthsAgo) keysToDelete.push(dateStr);
                } catch (e) { keysToDelete.push(dateStr); }
            });
            keysToDelete.forEach(key => delete reports[key]);
            localStorage.setItem('warehouseReports', JSON.stringify(reports));
        }
        function cleanOldPersonnelReports() {
            const sixMonthsAgo = new Date();
            sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);
            const keysToDelete = [];
            Object.keys(personnelReports).forEach(dateStr => {
                try {
                    const [day, month, year] = dateStr.split('.').map(Number);
                    const reportDate = new Date(year, month - 1, day);
                    if (reportDate < sixMonthsAgo) keysToDelete.push(dateStr);
                } catch (e) { keysToDelete.push(dateStr); }
            });
            keysToDelete.forEach(key => delete personnelReports[key]);
            localStorage.setItem('personnelReports', JSON.stringify(personnelReports));
        }
        function fillTestData() {
            const today = new Date();
            const testDates = [];
            for (let i = 0; i < 5; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                testDates.push(date.toLocaleDateString('ru-RU'));
            }
            const testWarehouses = [
                "–í–ï–õ–ò–ö–ò–ô_–ù–û–í–ì–û–†–û–î_–•–ê–ë_–ù–ï–•–ò–ù–°–ö–ê–Ø",
                "–ü–°–ö–û–í_–•–ê–ë_–ù–û–í–´–ô",
                "–í–û–õ–û–ì–î–ê_–•–ê–ë_–ë–ï–õ–û–ó–ï–†–°–ö–û–ï"
            ];
            testDates.forEach(dateStr => {
                if (!reports[dateStr]) reports[dateStr] = {};
                testWarehouses.forEach((wh, whIndex) => {
                    if (!reports[dateStr][wh]) reports[dateStr][wh] = {};
                    reports[dateStr][wh].day = {
                        '–û–±—Ä–∞–±–æ—Ç–∫–∞': { plan: String(200 + whIndex * 30), fact: String(210 + whIndex * 30), delta: 10 },
                        '–ü–µ—Ä—Å–æ–Ω–∞–ª': { plan: String(15 + whIndex), fact: String(15 + whIndex), delta: 0 },
                        '–û–∫–æ–Ω—á–∞–Ω–∏–µ –≤—ã–¥–∞—á–∏': { plan: '12:30', fact: '12:25', delta: '–ù–æ—Ä–º–∞' },
                        '–û–±—Ä–∞–±–æ—Ç–∫–∞ FBS': { plan: String(12 + whIndex), fact: String(11 + whIndex), delta: -1 },
                        '–í–æ–∑–≤—Ä–∞—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ (–ë—ç–∫–ª–æ–≥)': { plan: String(5), fact: String(7), delta: 2 },
                        '–û–±–µ–∑–ª–∏—á–∫–∞': { value: String(10 + whIndex) },
                        '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': { plan: String(95 + whIndex), fact: String(98 + whIndex), delta: 3 },
                        '–ö–æ–ª-–≤–æ –ø–∞–ª–ª–µ—Ç–∞-–º–µ—Å—Ç –∫ –æ—Ç–≥—Ä—É–∑–∫–µ': { 'FBS': String(20 + whIndex), 'X-Dock': String(15 + whIndex), '–í–æ–∑–≤—Ä–∞—Ç—ã': String(5 + whIndex) },
                        '–•—Ä–æ–Ω—å –•–î': { '–°–æ—Ä—Ç': String(30 + whIndex), '–ù–æ–Ω-–°–æ—Ä—Ç': String(25 + whIndex) },
                        '–†–∏—Å–∫–∏': { value: (whIndex % 2 === 0 ? 'yes' : 'no') },
                        '–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –í—ã–¥–∞—á–∞': { value: String(50 + whIndex * 10) },
                        '% –Ω–µ –ø—Ä–æ—Ñ–∏–ª—è': { value: String(5 + whIndex) },
                        '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å': { value: (whIndex % 2 === 0 ? '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.' : '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.') }
                    };
                    reports[dateStr][wh].night = {
                        '–û–±—Ä–∞–±–æ—Ç–∫–∞': { plan: String(100 + whIndex * 15), fact: String(105 + whIndex * 15), delta: 5 },
                        '–ü–µ—Ä—Å–æ–Ω–∞–ª': { plan: String(8 + whIndex), fact: String(8 + whIndex), delta: 0 },
                        '–û–∫–æ–Ω—á–∞–Ω–∏–µ –≤—ã–¥–∞—á–∏': { plan: '03:00', fact: '03:15', delta: '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ' },
                        '–û–±—Ä–∞–±–æ—Ç–∫–∞ FBS': { plan: String(15), fact: String(14), delta: -1 },
                        '–í–æ–∑–≤—Ä–∞—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ (–ë—ç–∫–ª–æ–≥)': { plan: String(3), fact: String(4), delta: 1 },
                        '–û–±–µ–∑–ª–∏—á–∫–∞': { value: String(5 + whIndex) },
                        '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': { plan: String(90 + whIndex), fact: String(92 + whIndex), delta: 2 },
                        '–ö–æ–ª-–≤–æ –ø–∞–ª–ª–µ—Ç–∞-–º–µ—Å—Ç –∫ –æ—Ç–≥—Ä—É–∑–∫–µ': { 'FBS': String(10 + whIndex), 'X-Dock': String(8 + whIndex), '–í–æ–∑–≤—Ä–∞—Ç—ã': String(3 + whIndex) },
                        '–•—Ä–æ–Ω—å –•–î': { '–°–æ—Ä—Ç': String(15 + whIndex), '–ù–æ–Ω-–°–æ—Ä—Ç': String(12 + whIndex) },
                        '–†–∏—Å–∫–∏': { value: (whIndex % 2 === 1 ? 'yes' : 'no') },
                        '–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –í—ã–¥–∞—á–∞': { value: String(25 + whIndex * 5) },
                        '% –Ω–µ –ø—Ä–æ—Ñ–∏–ª—è': { value: String(3 + whIndex) },
                        '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å': { value: (whIndex % 2 === 1 ? '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.' : '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.') }
                    };
                });
            });
            localStorage.setItem('warehouseReports', JSON.stringify(reports));
            alert(`‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!\nüì¶ –°–∫–ª–∞–¥—ã: ${testWarehouses.length}\nüìÖ –î–∞—Ç: ${testDates.length}\nüî¢ –ó–∞–ø–∏—Å–µ–π: ${testWarehouses.length * testDates.length * 2}`);
        }
        function fillPersonnelTestData() {
            const today = new Date();
            const testDates = [];
            for (let i = 0; i < 5; i++) {
                const d = new Date(today);
                d.setDate(today.getDate() - i);
                testDates.push(d.toLocaleDateString('ru-RU'));
            }
            const testObjects = [
                "–í–ï–õ–ò–ö–ò–ô_–ù–û–í–ì–û–†–û–î_–•–ê–ë_–ù–ï–•–ò–ù–°–ö–ê–Ø",
                "–ü–°–ö–û–í_–•–ê–ë_–ù–û–í–´–ô",
                "–í–û–õ–û–ì–î–ê_–•–ê–ë_–ë–ï–õ–û–ó–ï–†–°–ö–û–ï"
            ];
            testDates.forEach(dateStr => {
                if (!personnelReports[dateStr]) personnelReports[dateStr] = {};
                testObjects.forEach((obj, objIndex) => {
                    if (!personnelReports[dateStr][obj]) personnelReports[dateStr][obj] = {};
                    personnelReports[dateStr][obj].day = {
                        '–®—Ç–∞—Ç': { –ü–ª–∞–Ω: 20 + objIndex * 5, –§–∞–∫—Ç: 22 + objIndex * 5, –î–µ–ª—å—Ç–∞: 2 },
                        'Ozon Job': { –ü–ª–∞–Ω: 10 + objIndex * 2, –§–∞–∫—Ç: 12 + objIndex * 2, –ö–∞–ø–∞—Å–∏—Ç–µ—Ç: 15 + objIndex * 2, '–î–æ–ª—è OJ%': '50%' },
                        '–†–í': { value: '2' },
                        '–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞': { value: '1' },
                        'Total': { –ü–ª–∞–Ω: 30 + objIndex * 5, –§–∞–∫—Ç: 32 + objIndex * 5, –î–µ–ª—å—Ç–∞: 2 },
                        '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': { value: '95%' },
                        '–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞': { –û–¢: '1', –ë–õ: '0', –ù–ù: '0' },
                        '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏': { value: '–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ' },
                        '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å': { value: objIndex % 2 === 0 ? '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.' : '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.' }
                    };
                    personnelReports[dateStr][obj].night = {
                        '–®—Ç–∞—Ç': { –ü–ª–∞–Ω: 10 + objIndex * 3, –§–∞–∫—Ç: 11 + objIndex * 3, –î–µ–ª—å—Ç–∞: 1 },
                        'Ozon Job': { –ü–ª–∞–Ω: 5 + objIndex, –§–∞–∫—Ç: 6 + objIndex, –ö–∞–ø–∞—Å–∏—Ç–µ—Ç: 8 + objIndex, '–î–æ–ª—è OJ%': '55%' },
                        '–†–í': { value: '1' },
                        '–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞': { value: '0' },
                        'Total': { –ü–ª–∞–Ω: 15 + objIndex * 3, –§–∞–∫—Ç: 16 + objIndex * 3, –î–µ–ª—å—Ç–∞: 1 },
                        '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': { value: '90%' },
                        '–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞': { –û–¢: '0', –ë–õ: '1', –ù–ù: '0' },
                        '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏': { value: '–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–æ—á—å)' },
                        '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å': { value: objIndex % 2 === 1 ? '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 1 –®—É—Ç–∏–Ω –î.–ú.' : '–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è 2 –õ—é–±–∞–≤–∫—Å–∫–∞—è –ú.–ò.' }
                    };
                });
            });
            localStorage.setItem('personnelReports', JSON.stringify(personnelReports));
            alert(`‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É –∑–∞–≥—Ä—É–∂–µ–Ω—ã!\nüì¶ –û–±—ä–µ–∫—Ç–æ–≤: ${testObjects.length}\nüìÖ –î–∞—Ç: ${testDates.length}`);
        }
        function generateWarehouseList() {
            const list = document.getElementById('warehouseList');
            list.innerHTML = '';
            WAREHOUSES.forEach(wh => {
                const btn = document.createElement('button');
                btn.className = 'warehouse-btn';
                btn.textContent = wh;
                btn.onclick = () => showWarehouseReport(wh);
                list.appendChild(btn);
            });
        }
        function generatePersonnelList() {
            const list = document.getElementById('personnelList');
            list.innerHTML = '';
            PERSONNEL_OBJECTS.forEach(obj => {
                const btn = document.createElement('button');
                btn.className = 'warehouse-btn';
                btn.textContent = obj;
                btn.onclick = () => showPersonnelReport(obj);
                list.appendChild(btn);
            });
        }
        function selectReport(reportType) {
            document.getElementById('mainSection').classList.remove('active');
            currentDate = new Date();
            if (reportType === 'operational') {
                document.getElementById('warehouseReportSection').classList.add('active');
                showWarehouseReport(WAREHOUSES[0]);
            } else {
                document.getElementById('personnelReportSection').classList.add('active');
                showPersonnelReport(PERSONNEL_OBJECTS[0]);
            }
        }
        function showWarehouseReport(wh) {
            currentWarehouse = wh;
            document.getElementById('warehouseTitle').textContent = `üìç ${wh}`;
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('warehouseReportSection').classList.add('active');
            selectedWarehouseDate = currentDate.toLocaleDateString('ru-RU');
            document.getElementById('selectedWarehouseDate').innerHTML = `<strong>–í—ã–±—Ä–∞–Ω–æ:</strong> ${selectedWarehouseDate}`;
            renderWarehouseCalendar();
            loadCategoryInputs();
        }
        function showPersonnelReport(obj) {
            currentPersonnelObj = obj;
            document.getElementById('personnelTitle').textContent = `üìç ${obj}`;
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('personnelReportSection').classList.add('active');
            selectedPersonnelDate = currentDate.toLocaleDateString('ru-RU');
            document.getElementById('selectedPersonnelDate').innerHTML = `<strong>–í—ã–±—Ä–∞–Ω–æ:</strong> ${selectedPersonnelDate}`;
            renderPersonnelCalendar();
            loadPersonnelCategoryInputs();
        }
        function renderCalendar(calendarId, view, onSelect, selectedDateStr = null) {
            const cal = document.getElementById(calendarId);
            cal.innerHTML = '';
            const days = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            days.forEach(d => {
                const h = document.createElement('div');
                h.className = 'calendar-header';
                h.textContent = d;
                cal.appendChild(h);
            });
            let dates = [];
            if (view === 'week') {
                const mon = new Date(currentDate);
                mon.setDate(mon.getDate() - ((mon.getDay() || 7) - 1));
                for (let i = 0; i < 7; i++) {
                    const d = new Date(mon);
                    d.setDate(mon.getDate() + i);
                    dates.push({ date: d, day: d.getDate(), empty: false });
                }
            } else {
                const y = currentDate.getFullYear(), m = currentDate.getMonth();
                const first = new Date(y, m, 1), last = new Date(y, m + 1, 0), start = first.getDay() || 7;
                for (let i = 0; i < start - 1; i++) {
                    const b = document.createElement('button');
                    b.className = 'date-btn empty';
                    b.disabled = true;
                    cal.appendChild(b);
                }
                for (let day = 1; day <= last.getDate(); day++) {
                    const d = new Date(y, m, day);
                    dates.push({ date: d, day: day, empty: false });
                }
            }
            dates.forEach(o => {
                const b = document.createElement('button');
                b.className = `date-btn ${o.empty ? 'empty' : ''}`;
                b.textContent = o.day;
                if (!o.empty && selectedDateStr === o.date.toLocaleDateString('ru-RU')) b.classList.add('selected');
                if (!o.empty) b.onclick = () => onSelect(o.date);
                cal.appendChild(b);
            });
        }
        function renderWarehouseCalendar() {
            renderCalendar('warehouseCalendar', warehouseCalendarView, (date) => {
                currentDate = date;
                selectedWarehouseDate = currentDate.toLocaleDateString('ru-RU');
                document.getElementById('selectedWarehouseDate').innerHTML = `<strong>–í—ã–±—Ä–∞–Ω–æ:</strong> ${selectedWarehouseDate}`;
                renderWarehouseCalendar();
                loadCategoryInputs();
            }, selectedWarehouseDate);
        }
        function renderPersonnelCalendar() {
            renderCalendar('personnelCalendar', personnelCalendarView, (date) => {
                currentDate = date;
                selectedPersonnelDate = currentDate.toLocaleDateString('ru-RU');
                document.getElementById('selectedPersonnelDate').innerHTML = `<strong>–í—ã–±—Ä–∞–Ω–æ:</strong> ${selectedPersonnelDate}`;
                renderPersonnelCalendar();
                loadPersonnelCategoryInputs();
            }, selectedPersonnelDate);
        }
        function renderSummaryCalendar() {
            renderCalendar('summaryCalendar', summaryCalendarView, (date) => {
                selectedSummaryDate = date.toLocaleDateString('ru-RU');
                document.getElementById('currentSummaryDate').textContent = selectedSummaryDate;
            }, selectedSummaryDate);
        }
        function renderPersonnelSummaryCalendar() {
            renderCalendar('personnelSummaryCalendar', personnelSummaryCalendarView, (date) => {
                selectedPersonnelSummaryDate = date.toLocaleDateString('ru-RU');
                document.getElementById('currentPersonnelSummaryDate').textContent = selectedPersonnelSummaryDate;
            }, selectedPersonnelSummaryDate);
        }
        function prevPeriod() {
            warehouseCalendarView === 'week' ? currentDate.setDate(currentDate.getDate() - 7) : currentDate.setMonth(currentDate.getMonth() - 1);
            renderWarehouseCalendar();
        }
        function nextPeriod() {
            warehouseCalendarView === 'week' ? currentDate.setDate(currentDate.getDate() + 7) : currentDate.setMonth(currentDate.getMonth() + 1);
            renderWarehouseCalendar();
        }
        function toggleCalendarView() {
            warehouseCalendarView = warehouseCalendarView === 'week' ? 'month' : 'week';
            document.getElementById('warehouseViewToggleText').textContent = warehouseCalendarView === 'week' ? 'üìÖ –ù–µ–¥–µ–ª—è' : 'üìÜ –ú–µ—Å—è—Ü';
            renderWarehouseCalendar();
        }
        function prevPeriodPersonnel() {
            personnelCalendarView === 'week' ? currentDate.setDate(currentDate.getDate() - 7) : currentDate.setMonth(currentDate.getMonth() - 1);
            renderPersonnelCalendar();
        }
        function nextPeriodPersonnel() {
            personnelCalendarView === 'week' ? currentDate.setDate(currentDate.getDate() + 7) : currentDate.setMonth(currentDate.getMonth() + 1);
            renderPersonnelCalendar();
        }
        function toggleCalendarViewPersonnel() {
            personnelCalendarView = personnelCalendarView === 'week' ? 'month' : 'week';
            document.getElementById('personnelViewToggleText').textContent = personnelCalendarView === 'week' ? 'üìÖ –ù–µ–¥–µ–ª—è' : 'üìÜ –ú–µ—Å—è—Ü';
            renderPersonnelCalendar();
        }
        function prevPeriodSummary() {
            summaryCalendarView === 'week' ? currentDate.setDate(currentDate.getDate() - 7) : currentDate.setMonth(currentDate.getMonth() - 1);
            renderSummaryCalendar();
        }
        function nextPeriodSummary() {
            summaryCalendarView === 'week' ? currentDate.setDate(currentDate.getDate() + 7) : currentDate.setMonth(currentDate.getMonth() + 1);
            renderSummaryCalendar();
        }
        function toggleCalendarViewSummary() {
            summaryCalendarView = summaryCalendarView === 'week' ? 'month' : 'week';
            document.getElementById('summaryViewToggleText').textContent = summaryCalendarView === 'week' ? 'üìÖ –ù–µ–¥–µ–ª—è' : 'üìÜ –ú–µ—Å—è—Ü';
            renderSummaryCalendar();
        }
        function prevPersonnelSummaryDay() {
            if (!selectedPersonnelSummaryDate) return;
            const [day, month, year] = selectedPersonnelSummaryDate.split('.').map(Number);
            const date = new Date(year, month - 1, day);
            date.setDate(date.getDate() - 1);
            selectedPersonnelSummaryDate = date.toLocaleDateString('ru-RU');
            document.getElementById('currentPersonnelSummaryDate').textContent = selectedPersonnelSummaryDate;
        }
        function nextPersonnelSummaryDay() {
            if (!selectedPersonnelSummaryDate) return;
            const [day, month, year] = selectedPersonnelSummaryDate.split('.').map(Number);
            const date = new Date(year, month - 1, day);
            date.setDate(date.getDate() + 1);
            selectedPersonnelSummaryDate = date.toLocaleDateString('ru-RU');
            document.getElementById('currentPersonnelSummaryDate').textContent = selectedPersonnelSummaryDate;
        }
        function toggleCalendarViewPersonnelSummary() {
            personnelSummaryCalendarView = personnelSummaryCalendarView === 'week' ? 'month' : 'week';
            document.getElementById('personnelSummaryViewToggleText').textContent = personnelSummaryCalendarView === 'week' ? 'üìÖ –ù–µ–¥–µ–ª—è' : 'üìÜ –ú–µ—Å—è—Ü';
            renderPersonnelSummaryCalendar();
        }
        function loadCategoryInputs() {
            if (!selectedWarehouseDate) return;
            const type = document.querySelector('input[name="warehouseReportType"]:checked').value;
            const div = document.getElementById('categoryInputs');
            div.innerHTML = '';
            CATEGORIES.forEach(cat => {
                const data = reports[selectedWarehouseDate]?.[currentWarehouse]?.[type]?.[cat.name] || {};
                const cd = document.createElement('div');
                cd.className = 'category-input';
                let html = `<h4>${cat.name}</h4>`;
                if (cat.type === 'number') {
                    html += `
                        <div class="input-row">
                            <div><label>–ü–ª–∞–Ω:</label><input type="number" id="${currentWarehouse}_${type}_${cat.name}_plan" placeholder="–ü–ª–∞–Ω" value="${data.plan || ''}"></div>
                            <div><label>–§–∞–∫—Ç:</label><input type="number" id="${currentWarehouse}_${type}_${cat.name}_fact" placeholder="–§–∞–∫—Ç" value="${data.fact || ''}"></div>
                        </div>
                        <div class="delta-display">–î–µ–ª—å—Ç–∞: <span id="${currentWarehouse}_${type}_${cat.name}_delta"></span></div>
                    `;
                } else if (cat.type === 'time') {
                    html += `
                        <div class="input-row">
                            <div><label>–ü–ª–∞–Ω (–ß–ß:–ú–ú):</label><input type="text" id="${currentWarehouse}_${type}_${cat.name}_plan" placeholder="12:30" value="${data.plan || ''}"></div>
                            <div><label>–§–∞–∫—Ç (–ß–ß:–ú–ú):</label><input type="text" id="${currentWarehouse}_${type}_${cat.name}_fact" placeholder="12:25" value="${data.fact || ''}"></div>
                        </div>
                        <div class="delta-display"><span id="${currentWarehouse}_${type}_${cat.name}_delta"></span></div>
                    `;
                } else if (cat.type === 'single') {
                    html += `<div><label>${cat.label} (${cat.unit}):</label><input type="number" id="${currentWarehouse}_${type}_${cat.name}_value" placeholder="${cat.label}" value="${data.value || ''}"></div>`;
                } else if (cat.type === 'triple') {
                    html += `<div class="input-triple">`;
                    cat.fields.forEach(f => html += `<div><label>${f.n} (${f.u}):</label><input type="number" id="${currentWarehouse}_${type}_${cat.name}_${f.n}" placeholder="${f.n}" value="${data[f.n] || ''}"></div>`);
                    html += `</div>`;
                } else if (cat.type === 'double') {
                    html += `<div class="input-double">`;
                    cat.fields.forEach(f => html += `<div><label>${f.n} (${f.u}):</label><input type="number" id="${currentWarehouse}_${type}_${cat.name}_${f.n}" placeholder="${f.n}" value="${data[f.n] || ''}"></div>`);
                    html += `</div>`;
                } else if (cat.type === 'yesno') {
                    const val = data.value || '';
                    html += `
                        <div class="yesno-buttons">
                            <button type="button" class="yesno-btn yes ${val === 'yes' ? 'selected' : ''}" onclick="selectYesNo('${currentWarehouse}','${type}','${cat.name}','yes',event)">–î–ê</button>
                            <button type="button" class="yesno-btn no ${val === 'no' ? 'selected' : ''}" onclick="selectYesNo('${currentWarehouse}','${type}','${cat.name}','no',event)">–ù–ï–¢</button>
                        </div>
                        <input type="hidden" id="${currentWarehouse}_${type}_${cat.name}_value" value="${val}">
                    `;
                } else if (cat.type === 'select') {
                    html += `
                        <div>
                            <label>–í—ã–±–µ—Ä–∏—Ç–µ:</label>
                            <select id="${currentWarehouse}_${type}_${cat.name}_value">
                                <option value="">-- –ù–µ –≤—ã–±—Ä–∞–Ω–æ --</option>
                                ${cat.options.map(opt => `<option value="${opt}" ${data.value === opt ? 'selected' : ''}>${opt}</option>`).join('')}
                            </select>
                        </div>
                    `;
                }
                cd.innerHTML = html;
                div.appendChild(cd);
                if (cat.type === 'number' || cat.type === 'time') {
                    const planEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_plan`);
                    const factEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_fact`);
                    const update = () => {
                        const plan = planEl.value.trim();
                        const fact = factEl.value.trim();
                        const span = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_delta`);
                        if (!span) return;
                        if (cat.type === 'number') {
                            const p = parseInt(plan) || 0, f = parseInt(fact) || 0, delta = f - p;
                            span.textContent = delta;
                            span.className = delta >= 0 ? 'positive' : 'negative';
                        } else if (cat.type === 'time') {
                            if (plan && fact) {
                                const pMin = parseTimeToMin(plan), fMin = parseTimeToMin(fact);
                                if (!isNaN(pMin) && !isNaN(fMin)) {
                                    const ok = fMin <= pMin;
                                    span.textContent = ok ? '–ù–æ—Ä–º–∞' : '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ';
                                    span.className = ok ? 'good' : 'bad';
                                } else {
                                    span.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–ß–ß:–ú–ú)';
                                    span.className = 'bad';
                                }
                            } else {
                                span.textContent = '';
                            }
                        }
                    };
                    planEl.addEventListener('input', update);
                    factEl.addEventListener('input', update);
                    update();
                }
            });
        }
        function loadPersonnelCategoryInputs() {
            if (!selectedPersonnelDate || !currentPersonnelObj) return;
            const type = document.querySelector('input[name="personnelReportType"]:checked').value;
            const div = document.getElementById('personnelCategoryInputs');
            div.innerHTML = '';
            PERSONNEL_CATEGORIES.forEach(cat => {
                const data = personnelReports[selectedPersonnelDate]?.[currentPersonnelObj]?.[type]?.[cat.name] || {};
                const cd = document.createElement('div');
                cd.className = 'category-input';
                let html = `<h4>${cat.name}</h4>`;
                if (cat.type === 'triple') {
                    html += `<div class="input-triple">`;
                    cat.fields.forEach(f => {
                        if (f.n === '–î–µ–ª—å—Ç–∞') {
                            html += `<div><label>${f.n}:</label><span id="${currentPersonnelObj}_${type}_${cat.name}_${f.n}">${data[f.n] || '-'}</span></div>`;
                        } else {
                            html += `<div><label>${f.n}:</label><input type="number" id="${currentPersonnelObj}_${type}_${cat.name}_${f.n}" placeholder="${f.n}" value="${data[f.n] || ''}"></div>`;
                        }
                    });
                    html += `</div>`;
                } else if (cat.type === 'quadruple') {
                    html += `<div class="input-quadruple">`;
                    cat.fields.forEach(f => {
                        if (f.n === '–î–æ–ª—è OJ%') {
                            html += `<div><label>${f.n}:</label><span id="${currentPersonnelObj}_${type}_${cat.name}_${f.n}">${data[f.n] || '-'}</span></div>`;
                        } else {
                            html += `<div><label>${f.n}:</label><input type="number" id="${currentPersonnelObj}_${type}_${cat.name}_${f.n}" placeholder="${f.n}" value="${data[f.n] || ''}"></div>`;
                        }
                    });
                    html += `</div>`;
                } else if (cat.type === 'single') {
                    html += `<div><label>${cat.label}:</label><input type="text" id="${currentPersonnelObj}_${type}_${cat.name}_value" placeholder="${cat.label}" value="${data.value || ''}"></div>`;
                } else if (cat.type === 'select') {
                    html += `
                        <div>
                            <label>–í—ã–±–µ—Ä–∏—Ç–µ:</label>
                            <select id="${currentPersonnelObj}_${type}_${cat.name}_value">
                                <option value="">-- –ù–µ –≤—ã–±—Ä–∞–Ω–æ --</option>
                                ${cat.options.map(opt => `<option value="${opt}" ${data.value === opt ? 'selected' : ''}>${opt}</option>`).join('')}
                            </select>
                        </div>
                    `;
                }
                cd.innerHTML = html;
                div.appendChild(cd);
                if (cat.name === '–®—Ç–∞—Ç') {
                    const planEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–ü–ª–∞–Ω`);
                    const factEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–§–∞–∫—Ç`);
                    const deltaEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–î–µ–ª—å—Ç–∞`);
                    const updateDelta = () => {
                        const plan = parseInt(planEl.value) || 0;
                        const fact = parseInt(factEl.value) || 0;
                        deltaEl.textContent = fact - plan;
                        deltaEl.className = (fact - plan) >= 0 ? 'positive' : 'negative';
                    };
                    planEl.addEventListener('input', updateDelta);
                    factEl.addEventListener('input', updateDelta);
                    updateDelta();
                } else if (cat.name === 'Ozon Job') {
                    const factOJEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–§–∞–∫—Ç`);
                    const totalFactEl = document.getElementById(`${currentPersonnelObj}_${type}_Total_–§–∞–∫—Ç`);
                    const ojPercentEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–î–æ–ª—è OJ%`);
                    const updateOJPercent = () => {
                        const factOJ = parseInt(factOJEl.value) || 0;
                        const totalFact = parseInt(totalFactEl.value) || 1;
                        const percent = Math.round((factOJ / totalFact) * 100);
                        ojPercentEl.textContent = percent + '%';
                    };
                    factOJEl.addEventListener('input', updateOJPercent);
                    totalFactEl.addEventListener('input', updateOJPercent);
                    updateOJPercent();
                } else if (cat.name === 'Total') {
                    const planEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–ü–ª–∞–Ω`);
                    const factEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–§–∞–∫—Ç`);
                    const deltaEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_–î–µ–ª—å—Ç–∞`);
                    const updateDelta = () => {
                        const plan = parseInt(planEl.value) || 0;
                        const fact = parseInt(factEl.value) || 0;
                        deltaEl.textContent = fact - plan;
                        deltaEl.className = (fact - plan) >= 0 ? 'positive' : 'negative';
                    };
                    planEl.addEventListener('input', updateDelta);
                    factEl.addEventListener('input', updateDelta);
                    updateDelta();
                }
            });
        }
        function selectYesNo(wh, t, cat, val, e) {
            e.preventDefault();
            document.getElementById(`${wh}_${t}_${cat}_value`).value = val;
            e.target.parentElement.querySelectorAll('.yesno-btn').forEach(b => b.classList.remove('selected'));
            e.target.classList.add('selected');
        }
        function parseTimeToMin(timeStr) {
            const parts = timeStr.split(':');
            if (parts.length !== 2) return NaN;
            const h = parseInt(parts[0]) || 0;
            const m = parseInt(parts[1]) || 0;
            return h * 60 + m;
        }
        function saveWarehouseReport() {
            if (!selectedWarehouseDate) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É!');
            if (!currentWarehouse) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–ª–∞–¥!');
            const type = document.querySelector('input[name="warehouseReportType"]:checked').value;
            if (!reports[selectedWarehouseDate]) reports[selectedWarehouseDate] = {};
            if (!reports[selectedWarehouseDate][currentWarehouse]) reports[selectedWarehouseDate][currentWarehouse] = {};
            if (!reports[selectedWarehouseDate][currentWarehouse][type]) reports[selectedWarehouseDate][currentWarehouse][type] = {};
            CATEGORIES.forEach(cat => {
                let data = {};
                if (cat.type === 'number' || cat.type === 'time') {
                    const planEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_plan`);
                    const factEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_fact`);
                    if (planEl && factEl) {
                        const plan = planEl.value.trim();
                        const fact = factEl.value.trim();
                        let delta = '';
                        if (cat.type === 'number') {
                            const p = parseInt(plan) || 0;
                            const f = parseInt(fact) || 0;
                            delta = f - p;
                        } else if (cat.type === 'time') {
                            if (plan && fact) {
                                const pMin = parseTimeToMin(plan);
                                const fMin = parseTimeToMin(fact);
                                if (!isNaN(pMin) && !isNaN(fMin)) {
                                    delta = fMin <= pMin ? '–ù–æ—Ä–º–∞' : '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ';
                                }
                            }
                        }
                        data = { plan, fact, delta };
                    }
                } else if (cat.type === 'single') {
                    const valueEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_value`);
                    if (valueEl) data = { value: valueEl.value.trim() };
                } else if (cat.type === 'triple' || cat.type === 'double') {
                    cat.fields.forEach(f => {
                        const el = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_${f.n}`);
                        if (el) data[f.n] = el.value.trim();
                    });
                } else if (cat.type === 'yesno') {
                    const valueEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_value`);
                    if (valueEl) data = { value: valueEl.value.trim() };
                } else if (cat.type === 'select') {
                    const valueEl = document.getElementById(`${currentWarehouse}_${type}_${cat.name}_value`);
                    if (valueEl) data = { value: valueEl.value.trim() };
                }
                reports[selectedWarehouseDate][currentWarehouse][type][cat.name] = data;
            });
            localStorage.setItem('warehouseReports', JSON.stringify(reports));
            cleanOldReports();
            alert('‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ! –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –æ–±—â–µ–º —Å–≤–æ–¥–µ.');
            showSummarySection();
        }
        function savePersonnelReport() {
            if (!selectedPersonnelDate) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É!');
            if (!currentPersonnelObj) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç!');
            const type = document.querySelector('input[name="personnelReportType"]:checked').value;
            if (!personnelReports[selectedPersonnelDate]) personnelReports[selectedPersonnelDate] = {};
            if (!personnelReports[selectedPersonnelDate][currentPersonnelObj]) personnelReports[selectedPersonnelDate][currentPersonnelObj] = {};
            if (!personnelReports[selectedPersonnelDate][currentPersonnelObj][type]) personnelReports[selectedPersonnelDate][currentPersonnelObj][type] = {};
            PERSONNEL_CATEGORIES.forEach(cat => {
                const data = {};
                if (cat.type === 'triple' || cat.type === 'quadruple') {
                    cat.fields.forEach(f => {
                        const el = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_${f.n}`);
                        if (el) data[f.n] = el.value.trim();
                    });
                } else if (cat.type === 'single') {
                    const valueEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_value`);
                    if (valueEl) data.value = valueEl.value.trim();
                } else if (cat.type === 'select') {
                    const valueEl = document.getElementById(`${currentPersonnelObj}_${type}_${cat.name}_value`);
                    if (valueEl) data.value = valueEl.value.trim();
                }
                personnelReports[selectedPersonnelDate][currentPersonnelObj][type][cat.name] = data;
            });
            localStorage.setItem('personnelReports', JSON.stringify(personnelReports));
            cleanOldPersonnelReports();
            alert('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            showPersonnelSummarySection();
        }
        function showSummarySection() {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('summarySection').classList.add('active');
            selectedSummaryDate = currentDate.toLocaleDateString('ru-RU');
            document.getElementById('currentSummaryDate').textContent = selectedSummaryDate;
            renderSummaryCalendar();
        }
        function showPersonnelSummarySection() {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('personnelSummarySection').classList.add('active');
            selectedPersonnelSummaryDate = currentDate.toLocaleDateString('ru-RU');
            document.getElementById('currentPersonnelSummaryDate').textContent = selectedPersonnelSummaryDate;
            renderPersonnelSummaryCalendar();
        }
        function showSummaryData() {
            if (!selectedSummaryDate) return alert('‚ö†Ô∏è –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –¥–∞—Ç—É –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ!');
            const includeDay = document.getElementById('summaryDay').checked;
            const includeNight = document.getElementById('summaryNight').checked;
            if (!includeDay && !includeNight) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–∏–ø –æ—Ç—á—ë—Ç–∞!');
            const selectedManager = document.getElementById('managerFilter').value;
            document.getElementById('summarySection').classList.remove('active');
            document.getElementById('summaryTableSection').classList.add('active');
            const tableDiv = document.getElementById('summaryTable');
            let html = '<div class="table-wrapper"><table><thead><tr><th>–î–∞—Ç–∞</th><th>–°–∫–ª–∞–¥</th><th>–•–ê</th>';
            html += CATEGORIES.map(cat => {
                if (cat.type === 'single' || cat.type === 'yesno' || cat.type === 'select') return `<th>${cat.name}</th>`;
                if (cat.type === 'triple') return `<th colspan="3">${cat.name}</th>`;
                if (cat.type === 'double') return `<th colspan="2">${cat.name}</th>`;
                return `<th colspan="3">${cat.name}</th>`;
            }).join('') + '<th>–¢–∏–ø</th></tr>';
            html += '<tr><th>–î–∞—Ç–∞</th><th>–°–∫–ª–∞–¥</th><th>–•–ê</th>';
            html += CATEGORIES.map(cat => {
                if (cat.type === 'single') return `<th>${cat.unit}</th>`;
                if (cat.type === 'triple' || cat.type === 'double') return cat.fields.map(f => `<th>${f.u}</th>`).join('');
                if (cat.type === 'time') return '<th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>Œî</th>';
                if (cat.type === 'number') return '<th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>Œî</th>';
                return `<th>${cat.label}</th>`;
            }).join('') + '<th>–¢–∏–ø</th></tr></thead><tbody>';
            let totalVolumePlan = 0;
            const warehouseData = reports[selectedSummaryDate] || {};
            WAREHOUSES.forEach(wh => {
                const whData = warehouseData[wh] || {};
                let rowAdded = false;
                if (includeDay && whData.day) {
                    const managerValue = whData.day['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']?.value || '';
                    if (!selectedManager || managerValue === selectedManager) {
                        const rowData = addRow(selectedSummaryDate, wh, whData.day, '‚òÄÔ∏è');
                        html += rowData.html;
                        totalVolumePlan += rowData.volumePlan;
                        rowAdded = true;
                    }
                }
                if (includeNight && whData.night) {
                    const managerValue = whData.night['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']?.value || '';
                    if (!selectedManager || managerValue === selectedManager) {
                        const rowData = addRow(selectedSummaryDate, wh, whData.night, 'üåô');
                        html += rowData.html;
                        totalVolumePlan += rowData.volumePlan;
                        rowAdded = true;
                    }
                }
                if (!rowAdded) {
                    let cells = `<td>${selectedSummaryDate}</td><td>${wh}</td><td>–•–ê</td>`;
                    const numCols = CATEGORIES.reduce((acc, cat) => {
                        if (cat.type === 'single' || cat.type === 'yesno' || cat.type === 'select' || cat.type === 'time') return acc + 1;
                        if (cat.type === 'triple') return acc + 3;
                        if (cat.type === 'double') return acc + 2;
                        return acc + 3;
                    }, 0);
                    for (let i = 0; i < numCols; i++) cells += '<td>-</td>';
                    cells += '<td>-</td>';
                    html += `<tr>${cells}</tr>`;
                }
            });
            html += '</tbody></table></div>';
            html += `<div class="summary-total">üìä –ò—Ç–æ–≥–æ –ø–æ –û–±—ä—ë–º—É (–ø–ª–∞–Ω): ${totalVolumePlan}</div>`;
            tableDiv.innerHTML = html;
        }
        function addRow(date, wh, typeData, typeLabel) {
            let cells = '';
            let volumePlan = 0;
            cells += `<td>${date}</td><td>${wh}</td><td>–•–ê</td>`;
            CATEGORIES.forEach(cat => {
                const data = typeData[cat.name] || {};
                if (cat.type === 'single') {
                    cells += `<td>${data.value || '-'}</td>`;
                } else if (cat.type === 'yesno') {
                    const val = data.value || '';
                    const isBad = val === 'yes';
                    cells += `<td class="${isBad ? 'bad' : (val ? 'good' : '')}">${val ? (isBad ? '‚ùå' : '‚úÖ') : '-'}</td>`;
                } else if (cat.type === 'select') {
                    cells += `<td>${data.value || '-'}</td>`;
                } else if (cat.type === 'triple') {
                    cat.fields.forEach(f => cells += `<td>${data[f.n] || '-'}</td>`);
                } else if (cat.type === 'double') {
                    cat.fields.forEach(f => cells += `<td>${data[f.n] || '-'}</td>`);
                } else if (cat.type === 'time') {
                    cells += `<td>${data.plan || '-'}</td><td>${data.fact || '-'}</td>`;
                    const deltaText = data.delta || '';
                    const isGood = deltaText === '–ù–æ—Ä–º–∞';
                    cells += `<td class="${isGood ? 'good' : (deltaText ? 'bad' : '')}">${deltaText ? (isGood ? '‚úÖ' : '‚ùå') : '-'}</td>`;
                } else if (cat.type === 'number') {
                    cells += `<td>${data.plan || '-'}</td><td>${data.fact || '-'}</td>`;
                    const deltaCell = data.delta !== undefined && data.delta !== '' ? data.delta : '-';
                    const deltaClass = typeof deltaCell === 'number' ? (deltaCell >= 0 ? 'positive' : 'negative') : '';
                    cells += `<td class="${deltaClass}">${deltaCell}</td>`;
                    if (cat.name === '–û–±—Ä–∞–±–æ—Ç–∫–∞') {
                        const p = parseInt(data.plan) || 0;
                        volumePlan += p;
                    }
                }
            });
            cells += `<td>${typeLabel}</td>`;
            return { html: `<tr>${cells}</tr>`, volumePlan };
        }
        function showPersonnelSummaryData() {
            if (!selectedPersonnelSummaryDate) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É!');
            const includeDay = document.getElementById('personnelSummaryDay').checked;
            const includeNight = document.getElementById('personnelSummaryNight').checked;
            if (!includeDay && !includeNight) return alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–º–µ–Ω—ã!');
            const selectedManager = document.getElementById('personnelManagerFilter').value;
            document.getElementById('personnelSummarySection').classList.remove('active');
            document.getElementById('personnelSummaryTableSection').classList.add('active');
            const tableDiv = document.getElementById('personnelSummaryTable');
            let html = `
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th rowspan="2">–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è</th>
                                <th colspan="3">–®—Ç–∞—Ç</th>
                                <th colspan="4">Ozon Job</th>
                                <th rowspan="2">–†–í</th>
                                <th rowspan="2">–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞</th>
                                <th colspan="3">Total</th>
                                <th rowspan="2">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                                <th colspan="3">–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞</th>
                                <th rowspan="2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</th>
                                <th rowspan="2">–¢–∏–ø</th>
                            </tr>
                            <tr>
                                <th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>–î–µ–ª—å—Ç–∞</th>
                                <th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>–ö–∞–ø–∞—Å–∏—Ç–µ—Ç</th><th>–î–æ–ª—è OJ%</th>
                                <th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>–î–µ–ª—å—Ç–∞</th>
                                <th>–û–¢</th><th>–ë–õ</th><th>–ù–ù</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            PERSONNEL_OBJECTS.forEach(obj => {
                let rowAdded = false;
                const objData = personnelReports[selectedPersonnelSummaryDate]?.[obj] || {};
                if (includeDay && objData.day) {
                    const manager = objData.day['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']?.value || '';
                    if (!selectedManager || manager === selectedManager) {
                        html += `
                            <tr>
                                <td>${obj}</td>
                                <td>${objData.day['–®—Ç–∞—Ç']?.–ü–ª–∞–Ω || '-'}</td>
                                <td>${objData.day['–®—Ç–∞—Ç']?.–§–∞–∫—Ç || '-'}</td>
                                <td>${objData.day['–®—Ç–∞—Ç']?.–î–µ–ª—å—Ç–∞ || '-'}</td>
                                <td>${objData.day['Ozon Job']?.–ü–ª–∞–Ω || '-'}</td>
                                <td>${objData.day['Ozon Job']?.–§–∞–∫—Ç || '-'}</td>
                                <td>${objData.day['Ozon Job']?.–ö–∞–ø–∞—Å–∏—Ç–µ—Ç || '-'}</td>
                                <td>${objData.day['Ozon Job']?.['–î–æ–ª—è OJ%'] || '-'}</td>
                                <td>${objData.day['–†–í']?.value || '-'}</td>
                                <td>${objData.day['–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞']?.value || '-'}</td>
                                <td>${objData.day['Total']?.–ü–ª–∞–Ω || '-'}</td>
                                <td>${objData.day['Total']?.–§–∞–∫—Ç || '-'}</td>
                                <td>${objData.day['Total']?.–î–µ–ª—å—Ç–∞ || '-'}</td>
                                <td>${objData.day['–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å']?.value || '-'}</td>
                                <td>${objData.day['–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞']?.–û–¢ || '-'}</td>
                                <td>${objData.day['–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞']?.–ë–õ || '-'}</td>
                                <td>${objData.day['–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞']?.–ù–ù || '-'}</td>
                                <td>${objData.day['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏']?.value || '-'}</td>
                                <td>‚òÄÔ∏è –î–Ω–µ–≤–Ω–∞—è</td>
                            </tr>
                        `;
                        rowAdded = true;
                    }
                }
                if (includeNight && objData.night) {
                    const manager = objData.night['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']?.value || '';
                    if (!selectedManager || manager === selectedManager) {
                        html += `
                            <tr>
                                <td>${obj}</td>
                                <td>${objData.night['–®—Ç–∞—Ç']?.–ü–ª–∞–Ω || '-'}</td>
                                <td>${objData.night['–®—Ç–∞—Ç']?.–§–∞–∫—Ç || '-'}</td>
                                <td>${objData.night['–®—Ç–∞—Ç']?.–î–µ–ª—å—Ç–∞ || '-'}</td>
                                <td>${objData.night['Ozon Job']?.–ü–ª–∞–Ω || '-'}</td>
                                <td>${objData.night['Ozon Job']?.–§–∞–∫—Ç || '-'}</td>
                                <td>${objData.night['Ozon Job']?.–ö–∞–ø–∞—Å–∏—Ç–µ—Ç || '-'}</td>
                                <td>${objData.night['Ozon Job']?.['–î–æ–ª—è OJ%'] || '-'}</td>
                                <td>${objData.night['–†–í']?.value || '-'}</td>
                                <td>${objData.night['–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞']?.value || '-'}</td>
                                <td>${objData.night['Total']?.–ü–ª–∞–Ω || '-'}</td>
                                <td>${objData.night['Total']?.–§–∞–∫—Ç || '-'}</td>
                                <td>${objData.night['Total']?.–î–µ–ª—å—Ç–∞ || '-'}</td>
                                <td>${objData.night['–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å']?.value || '-'}</td>
                                <td>${objData.night['–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞']?.–û–¢ || '-'}</td>
                                <td>${objData.night['–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞']?.–ë–õ || '-'}</td>
                                <td>${objData.night['–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞']?.–ù–ù || '-'}</td>
                                <td>${objData.night['–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏']?.value || '-'}</td>
                                <td>üåô –ù–æ—á–Ω–∞—è</td>
                            </tr>
                        `;
                        rowAdded = true;
                    }
                }
                if (!rowAdded) {
                    html += `
                        <tr>
                            <td>${obj}</td>
                            <td>-</td><td>-</td><td>-</td>
                            <td>-</td><td>-</td><td>-</td><td>-</td>
                            <td>-</td><td>-</td>
                            <td>-</td><td>-</td><td>-</td>
                            <td>-</td>
                            <td>-</td><td>-</td><td>-</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                    `;
                }
            });
            html += `</tbody></table></div>`;
            tableDiv.innerHTML = html;
        }
        function prevSummaryDay() {
            if (!selectedSummaryDate) return;
            const [day, month, year] = selectedSummaryDate.split('.').map(Number);
            const date = new Date(year, month - 1, day);
            date.setDate(date.getDate() - 1);
            selectedSummaryDate = date.toLocaleDateString('ru-RU');
            document.getElementById('currentSummaryDate').textContent = selectedSummaryDate;
            showSummaryData();
        }
        function nextSummaryDay() {
            if (!selectedSummaryDate) return;
            const [day, month, year] = selectedSummaryDate.split('.').map(Number);
            const date = new Date(year, month - 1, day);
            date.setDate(date.getDate() + 1);
            selectedSummaryDate = date.toLocaleDateString('ru-RU');
            document.getElementById('currentSummaryDate').textContent = selectedSummaryDate;
            showSummaryData();
        }
        function toggleFullScreen() {
            const fs = document.getElementById('fullScreenTable');
            const tbl = document.getElementById('summaryTable').innerHTML;
            if (fs.style.display === 'none') {
                document.getElementById('fullSummaryTable').innerHTML = tbl;
                fs.style.display = 'block';
                document.body.style.overflow = 'hidden';
            } else {
                fs.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }
        function togglePersonnelFullScreen() {
            const fs = document.getElementById('personnelFullScreenTable');
            const tbl = document.getElementById('personnelSummaryTable').innerHTML;
            if (fs.style.display === 'none') {
                document.getElementById('fullPersonnelSummaryTable').innerHTML = tbl;
                fs.style.display = 'block';
                document.body.style.overflow = 'hidden';
            } else {
                fs.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }
        function backToMain() {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('mainSection').classList.add('active');
            currentWarehouse = '';
            currentPersonnelObj = '';
            selectedWarehouseDate = null;
            selectedPersonnelDate = null;
            selectedSummaryDate = null;
            selectedPersonnelSummaryDate = null;
        }
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('input[name="warehouseReportType"]').forEach(r => r.addEventListener('change', loadCategoryInputs));
            document.querySelectorAll('input[name="personnelReportType"]').forEach(r => r.addEventListener('change', loadPersonnelCategoryInputs));
        });
        window.onload = function() {
            cleanOldReports();
            cleanOldPersonnelReports();
            generateWarehouseList();
            generatePersonnelList();
            renderWarehouseCalendar();
            renderPersonnelCalendar();
            renderSummaryCalendar();
            renderPersonnelSummaryCalendar();
        };
    </script>
</body>
</html>
