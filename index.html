<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes">
<title>–ü–µ—Ä—Å–æ–Ω–∞–ª ‚Äì —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç</title>
<style>
:root{--p:#667eea;--s:#f093fb;--g:#43e97b;--r:#fa709a;--bg:#0a0e27;--text:#f0f4ff;--touch:44px}
body{margin:0;padding:10px;font-family:Inter,-apple-system,BlinkMacSystemFont;font-size:14px;
background:linear-gradient(135deg,var(--bg) 0%,#1a1f3a 50%,#2d1b3d 100%);color:var(--text)}
button,input,select{padding:12px 16px;border-radius:8px;border:none;font-size:14px}
button{background:linear-gradient(135deg,var(--p) 0%,var(--s) 100%);color:#fff;min-height:var(--touch)}
input[type=number]{width:100%;max-width:100px}
.section{display:none;animation:fadeIn .3s}.section.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}}
.header{background:linear-gradient(135deg,var(--p) 0%,#764ba2 50%,var(--s) 100%);padding:16px 20px;text-align:center}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin:15px 0}
.calendar-header{background:rgba(255,255,255,.1);padding:6px;text-align:center;font-size:11px}
.date-btn{background:rgba(255,255,255,.1);padding:8px 4px;cursor:pointer;border-radius:6px;font-size:12px}
.date-btn.selected{background:var(--p);color:#fff}
table{width:100%;border-collapse:collapse;font-size:11px;margin-top:10px}
th,td{border:1px solid rgba(255,255,255,.15);padding:4px;text-align:center}
th{background:rgba(255,255,255,.05);position:sticky;top:0}
.positive{color:var(--g)}.negative{color:var(--r)}
.summary-total{background:linear-gradient(135deg,var(--p) 0%,var(--s) 100%);padding:14px;border-radius:10px;text-align:center;font-weight:600;margin-top:10px}
</style>
</head>
<body>
<div class="header">
  <h2>üìä –ü–µ—Ä—Å–æ–Ω–∞–ª ‚Äì —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç</h2>
  <div style="font-size:12px">–°–∏—Å—Ç–µ–º–∞ —É—á—ë—Ç–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</div>
</div>
<!-- ========= 1. –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù ========= -->
<div id="mainSection" class="section active">
  <h3>–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç</h3>
  <div id="objectsList" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px;margin-bottom:20px"></div>
  <button onclick="showSummarySection()">üìà –°–≤–æ–¥ –ø–æ –≤—Å–µ–º –æ–±—ä–µ–∫—Ç–∞–º</button>
</div>
<!-- ========= 2. –≠–ö–†–ê–ù –û–ë–™–ï–ö–¢–ê (–≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö) ========= -->
<div id="inputSection" class="section">
  <h3 id="inputTitle"></h3>
  <div class="date-section">
    <h4>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h4>
    <div class="calendar-controls" style="display:flex;gap:10px;margin-bottom:10px">
      <button onclick="prevPeriod()">‚Üê</button>
      <button onclick="toggleView()"><span id="viewToggle">üìÜ –ú–µ—Å—è—Ü</span></button>
      <button onclick="nextPeriod()">‚Üí</button>
    </div>
    <div id="calendar" class="calendar"></div>
    <div id="selectedDate" class="selected-date-display"></div>
  </div>
  <div class="radio-group">
    <label><input type="radio" name="shift" value="day" checked> ‚òÄÔ∏è –î–Ω–µ–≤–Ω–∞—è</label>
    <label><input type="radio" name="shift" value="night"> üåô –ù–æ—á–Ω–∞—è</label>
  </div>
  <!-- –±–ª–æ–∫–∏ –¥–ª—è –≤–≤–æ–¥–∞ -->
  <div id="inputs"></div>
  <div class="action-buttons" style="display:flex;gap:10px;margin-top:15px">
    <button onclick="saveData()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button class="secondary" onclick="showMain()">‚Üê –ù–∞–∑–∞–¥</button>
  </div>
</div>
<!-- ========= 3. –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê ========= -->
<div id="summarySection" class="section">
  <h3>üìã –°–≤–æ–¥ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É</h3>
  <div class="checkbox-group">
    <label><input type="checkbox" id="dayCh" checked> ‚òÄÔ∏è –î–Ω–µ–≤–Ω–∞—è</label>
    <label><input type="checkbox" id="nightCh"> üåô –ù–æ—á–Ω–∞—è</label>
  </div>
  <div class="date-section">
    <h4>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h4>
    <div class="calendar-controls" style="display:flex;gap:10px">
      <button onclick="prevSum()">‚Üê</button>
      <button onclick="toggleSumView()"><span id="sumViewToggle">üìÜ –ú–µ—Å—è—Ü</span></button>
      <button onclick="nextSum()">‚Üí</button>
    </div>
    <div id="sumCalendar" class="calendar"></div>
  </div>
  <button onclick="buildSummaryTable()">üìà –ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É</button>
  <button class="secondary" onclick="showMain()">‚Üê –ù–∞–∑–∞–¥</button>
  <div id="sumTable"></div>
</div>
<script>
/*****************************************************************
 * 1. –î–ê–ù–ù–´–ï
 *****************************************************************/
const OBJECTS = [
  "–ê–†–•–ê–ù–ì–ï–õ–¨–°–ö_–•–ê–ë_–ù–ê–•–ò–ú–û–í–ê",
  "–ú–£–†–ú–ê–ù–°–ö_–•–ê–ë_–û–ë–™–ï–ó–î–ù–ê–Ø",
  "–í–ï–õ–ò–ö–ò–ô_–ù–û–í–ì–û–†–û–î_–•–ê–ë_–ù–ï–•–ò–ù–°–ö–ê–Ø",
  "–ü–ï–¢–†–û –ó–ê–í–û–î–°–ö_–•–ê–ë_–ü–†–Ø–ñ–ò–ù–°–ö–û–ï", // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ typo "–ü–ï–¢–†–û–ó–ê–í–û–î–°–ö"
  "–ü–°–ö–û–í_–•–ê–ë_–ú–ê–†–ì–ï–õ–û–í–ê",
  "–ü–°–ö–û–í_–•–ê–ë_–ù–û–í–´–ô",
  "–°–´–ö–¢–´–í–ö–ê–†_–•–ê–ë_–õ–ï–°–û–ü–ê–†–ö–û–í–ê–Ø",
  "–°–´–ö–¢–´–í–ö–ê–†_–•–ê–ë_–û–ö–¢–Ø–ë–†–¨–°–ö–ò–ô",
  "–ß–ï–†–ï–ü–û–í–ï–¶_–•–ê–ë_–°–¢–†–û–ô–ò–ù–î–£–°–¢–†–ò–ò",
  "–í–û–õ–û–ì–î–ê_–•–ê–ë_–ë–ï–õ–û–ó–ï–†–°–ö–û–ï"
];
// —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π (–¥–ª—è –∞–≤—Ç–æ—Å—É–º–º –∏ –∞–≤—Ç–æ-Œî)
const FIELDS = {
  staffPlan:  {label:"–®—Ç–∞—Ç –ø–ª–∞–Ω",      autoDelta:true},
  staffFact:  {label:"–®—Ç–∞—Ç —Ñ–∞–∫—Ç",      autoDelta:true},
  ozonPlan:   {label:"OzonJob –ø–ª–∞–Ω",   autoDelta:false},
  ozonFact:   {label:"OzonJob —Ñ–∞–∫—Ç",   autoDelta:false},
  ozonCap:    {label:"–ö–∞–ø–∞—Å–∏—Ç–∏",       autoDelta:false},
  rv:         {label:"–†–í",             autoDelta:false},
  cmd:        {label:"–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞",   autoDelta:false},
  totalPlan:  {label:"Total –ø–ª–∞–Ω",     autoDelta:false},
  totalFact:  {label:"Total —Ñ–∞–∫—Ç",     autoDelta:false},
  prod:       {label:"–ü—Ä–æ–∏–∑–≤–æ–¥-—Ç—å",    autoDelta:false},
  ot:         {label:"–û–¢",             autoDelta:false},
  bl:         {label:"–ë–õ",             autoDelta:false},
  nn:         {label:"–ù–ù",             autoDelta:false},
  comment:    {label:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",    autoDelta:false}
};
let data = JSON.parse(localStorage.getItem("personnelData") || "{}");
let currentDate = new Date();
let view = "month";          // –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –æ–±—ä–µ–∫—Ç–∞
let sumView = "month";       // –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å–≤–æ–¥–∞
let currentObj = "";
let selectedDateStr = "";
/*****************************************************************
2. –£–¢–ò–õ–ò–¢–´
*****************************************************************/
function fmt(d) { return d.toLocaleDateString("ru-RU"); }
function getShift() { return document.querySelector("input[name=shift]:checked").value; }
function $(id) { return document.getElementById(id); }
function el(tag, html) { 
  const e = document.createElement(tag); 
  if (html) e.innerHTML = html; 
  return e; 
}
/*****************************************************************
3. –≠–ö–†–ê–ù–´
*****************************************************************/
function showMain() {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  $("mainSection").classList.add("active");
}
function showSummarySection() {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  $("summarySection").classList.add("active");
  renderSumCalendar();
}
function showInput(obj) {
  currentObj = obj;
  $("inputTitle").textContent = "üìç" + obj;
  selectedDateStr = fmt(currentDate);
  $("selectedDate").innerHTML = "<strong>" + selectedDateStr + "</strong>";
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  $("inputSection").classList.add("active");
  renderCalendar();
  renderInputs();
}
/*****************************************************************
4. –°–ü–ò–°–û–ö –û–ë–™–ï–ö–¢–û–í
*****************************************************************/
function renderObjects() {
  const box = $("objectsList");
  box.innerHTML = "";
  OBJECTS.forEach(o => {
    const b = el("button", o);
    b.className = "warehouse-btn";
    b.onclick = () => showInput(o);
    box.appendChild(b);
  });
}
/*****************************************************************
5. –ö–ê–õ–ï–ù–î–ê–†–ò
*****************************************************************/
function renderCalendar() {
  const cal = $("calendar");
  const days = ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"];
  cal.innerHTML = "";
  days.forEach(d => {
    const header = el("div", d);
    header.className = "calendar-header";
    cal.appendChild(header);
  });
  let dates = [];
  if (view === "week") {
    const mon = new Date(currentDate);
    mon.setDate(mon.getDate() - ((mon.getDay() || 7) - 1));
    for (let i = 0; i < 7; i++) {
      const d = new Date(mon);
      d.setDate(mon.getDate() + i);
      dates.push(d);
    }
  } else {
    const y = currentDate.getFullYear();
    const m = currentDate.getMonth();
    const first = new Date(y, m, 1);
    const last = new Date(y, m + 1, 0);
    const start = (first.getDay() || 7);
    for (let i = 1; i < start; i++) {
      const e = el("button", " ");
      e.disabled = true;
      cal.appendChild(e);
    }
    for (let day = 1; day <= last.getDate(); day++) {
      dates.push(new Date(y, m, day));
    }
  }
  dates.forEach(d => {
    const b = el("button", d.getDate());
    b.className = "date-btn";
    if (fmt(d) === selectedDateStr) b.classList.add("selected");
    b.onclick = () => {
      selectedDateStr = fmt(d);
      $("selectedDate").innerHTML = "<strong>" + selectedDateStr + "</strong>";
      renderCalendar();
      renderInputs();
    };
    cal.appendChild(b);
  });
}
function renderSumCalendar() {
  const cal = $("sumCalendar");
  const days = ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"];
  cal.innerHTML = "";
  days.forEach(d => {
    const header = el("div", d);
    header.className = "calendar-header";
    cal.appendChild(header);
  });
  const y = currentDate.getFullYear();
  const m = currentDate.getMonth();
  const first = new Date(y, m, 1);
  const last = new Date(y, m + 1, 0);
  const start = (first.getDay() || 7);
  for (let i = 1; i < start; i++) {
    const e = el("button", " ");
    e.disabled = true;
    cal.appendChild(e);
  }
  for (let day = 1; day <= last.getDate(); day++) {
    const d = new Date(y, m, day);
    const b = el("button", d.getDate());
    b.className = "date-btn";
    b.onclick = () => {
      currentDate = d;
      renderSumCalendar();
    };
    cal.appendChild(b);
  }
}
function prevPeriod() {
  if (view === "week") {
    currentDate.setDate(currentDate.getDate() - 7);
  } else {
    currentDate.setMonth(currentDate.getMonth() - 1);
  }
  renderCalendar();
}
function nextPeriod() {
  if (view === "week") {
    currentDate.setDate(currentDate.getDate() + 7);
  } else {
    currentDate.setMonth(currentDate.getMonth() + 1);
  }
  renderCalendar();
}
function toggleView() {
  view = view === "week" ? "month" : "week";
  $("viewToggle").textContent = view === "week" ? "üìÖ –ù–µ–¥–µ–ª—è" : "üìÜ –ú–µ—Å—è—Ü";
  renderCalendar();
}
function prevSum() {
  currentDate.setMonth(currentDate.getMonth() - 1);
  renderSumCalendar();
}
function nextSum() {
  currentDate.setMonth(currentDate.getMonth() + 1);
  renderSumCalendar();
}
function toggleSumView() {
  sumView = sumView === "week" ? "month" : "week";
  $("sumViewToggle").textContent = sumView === "week" ? "üìÖ –ù–µ–¥–µ–ª—è" : "üìÜ –ú–µ—Å—è—Ü";
  renderSumCalendar();
}
/*****************************************************************
6. –ü–û–õ–Ø –í–í–û–î–ê
*****************************************************************/
function renderInputs() {
  const box = $("inputs");
  box.innerHTML = "";
  const shift = getShift();
  // —Å–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ
  if (!data[selectedDateStr]) data[selectedDateStr] = {};
  if (!data[selectedDateStr][currentObj]) data[selectedDateStr][currentObj] = {};
  if (!data[selectedDateStr][currentObj][shift]) data[selectedDateStr][currentObj][shift] = {};
  const d = data[selectedDateStr][currentObj][shift];
  // —Å—Ç—Ä–æ–∏–º –ø–æ–ª—è
  Object.entries(FIELDS).forEach(([key, meta]) => {
    const grp = el("div");
    grp.style.marginBottom = "10px";
    if (meta.autoDelta) {
      const plan = d[key] || "";
      const factKey = key.replace("Plan", "Fact");
      const fact = d[factKey] || "";
      const delta = (parseInt(fact) || 0) - (parseInt(plan) || 0);
      grp.innerHTML = `
        <label><strong>${meta.label}</strong></label>
        <div style="display:flex;gap:10px">
          <div>
            <label>–ü–ª–∞–Ω</label>
            <input type="number" id="${key}" value="${plan}" oninput="autoDelta()">
          </div>
          <div>
            <label>–§–∞–∫—Ç</label>
            <input type="number" id="${factKey}" value="${fact}" oninput="autoDelta()">
          </div>
          <div class="delta-display" style="padding:12px;border-radius:6px;background:rgba(255,255,255,.05)">
            Œî <span class="${delta >= 0 ? 'positive' : 'negative'}">${delta}</span>
          </div>
        </div>
      `;
    } else if (key === "ozonFact" || key === "totalFact") {
      grp.innerHTML = `
        <label><strong>${meta.label}</strong></label>
        <input type="number" id="${key}" value="${d[key] || ""}" oninput="autoCalc()">
      `;
    } else {
      grp.innerHTML = `
        <label><strong>${meta.label}</strong></label>
        <input type="number" id="${key}" value="${d[key] || ""}">
      `;
    }
    box.appendChild(grp);
  });
  // –ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞
  const reasons = el("div");
  reasons.innerHTML = `
    <label><strong>–ü—Ä–∏—á–∏–Ω—ã –Ω–µ–≤—ã—Ö–æ–¥–∞ —à—Ç–∞—Ç</strong></label>
    <div style="display:flex;gap:10px">
      <div><label>–û–¢</label><input type="number" id="ot" value="${d.ot || ""}"></div>
      <div><label>–ë–õ</label><input type="number" id="bl" value="${d.bl || ""}"></div>
      <div><label>–ù–ù</label><input type="number" id="nn" value="${d.nn || ""}"></div>
    </div>
    <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</label>
    <input type="text" id="comment" value="${d.comment || ""}" placeholder="–¢–µ–∫—Å—Ç">
  `;
  box.appendChild(reasons);
  autoDelta();
  autoCalc();
}
function autoDelta() {
  const plan = parseInt($("staffPlan").value) || 0;
  const fact = parseInt($("staffFact").value) || 0;
  const delta = fact - plan;
  const span = document.querySelector(".delta-display span");
  if (span) {
    span.textContent = delta;
    span.className = delta >= 0 ? "positive" : "negative";
  }
}
function autoCalc() {
  const oz = parseInt($("ozonFact").value) || 0;
  const tot = parseInt($("totalFact").value) || 0;
  const ojPct = document.getElementById("ojPct");
  if (tot > 0) {
    const pct = (oz / tot * 100).toFixed(1);
    ojPct.textContent = `–î–æ–ª—è OJ%: ${pct}%`;
  } else {
    ojPct.textContent = "–î–æ–ª—è OJ%: -";
  }
}
/*****************************************************************
7. –°–û–•–†–ê–ù–ï–ù–ò–ï
*****************************************************************/
function saveData() {
  const shift = getShift();
  const dateData = data[selectedDateStr] || {};
  const objData = dateData[currentObj] || {};
  const shiftData = objData[shift] || {};
  
  Object.keys(FIELDS).forEach(k => {
    const input = $(k);
    shiftData[k] = input ? input.value.trim() : '';
  });
  
  shiftData.ot = $("ot").value;
  shiftData.bl = $("bl").value;
  shiftData.nn = $("nn").value;
  shiftData.comment = $("comment").value;
  
  data[selectedDateStr] = dateData;
  dateData[currentObj] = objData;
  objData[shift] = shiftData;
  
  localStorage.setItem("personnelData", JSON.stringify(data));
  alert("‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ");
  showMain();
}
/*****************************************************************
8. –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê
*****************************************************************/
function buildSummaryTable() {
  const dayCh = $("dayCh").checked;
  const nightCh = $("nightCh").checked;
  if (!dayCh && !nightCh) {
    alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Å–º–µ–Ω—É");
    return;
  }
  const date = fmt(currentDate);
  const tbl = $("sumTable");
  tbl.innerHTML = "";
  
  let html = `<table>
    <thead>
      <tr>
        <th rowspan="2">–û–±—ä–µ–∫—Ç</th>
        <th colspan="3">–®—Ç–∞—Ç</th>
        <th colspan="4">Ozon Job</th>
        <th rowspan="2">–†–í</th>
        <th rowspan="2">–ö–ú–î</th>
        <th rowspan="2">Total –ü–ª–∞–Ω</th>
        <th rowspan="2">Total –§–∞–∫—Ç</th>
        <th rowspan="2">Œî</th>
        <th rowspan="2">–ü—Ä–æ–∏–∑-—Ç—å</th>
        <th colspan="4">–ü—Ä–∏—á–∏–Ω—ã</th>
        <th rowspan="2">–ö–æ–º–º–µ–Ω—Ç</th>
      </tr>
      <tr>
        <th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>Œî</th>
        <th>–ü–ª–∞–Ω</th><th>–§–∞–∫—Ç</th><th>–ö–∞–ø–∞—Å</th><th>–î–æ–ª—è OJ%</th>
        <th>–û–¢</th><th>–ë–õ</th><th>–ù–ù</th>
      </tr>
    </thead>
    <tbody>`;

  let totPlan = 0, totFact = 0;

  OBJECTS.forEach(obj => {
    const dayD = data[date]?.[obj]?.day || {};
    const nightD = data[date]?.[obj]?.night || {};
    const use = {};

    if (dayCh && nightCh) {
      // –°—É–º–º–∏—Ä—É–µ–º –¥–Ω–µ–≤–Ω—É—é –∏ –Ω–æ—á–Ω—É—é —Å–º–µ–Ω—ã
      ["staffPlan","staffFact","ozonPlan","ozonFact","ozonCap","rv","cmd","totalPlan","totalFact","prod","ot","bl","nn"].forEach(k => {
        const dayVal = parseInt(dayD[k]) || 0;
        const nightVal = parseInt(nightD[k]) || 0;
        use[k] = dayVal + nightVal;
      });
      use.comment = [dayD.comment, nightD.comment].filter(c => c).join(" / ");
    } else {
      const targetShift = dayCh ? "day" : "night";
      const shiftData = data[date]?.[obj]?.[targetShift] || {};
      Object.assign(use, shiftData);
      use.comment = use.comment || "";
    }

    const sp = parseInt(use.staffPlan) || 0;
    const sf = parseInt(use.staffFact) || 0;
    const sd = sf - sp;

    const op = parseInt(use.ozonPlan) || 0;
    const of = parseInt(use.ozonFact) || 0;
    const oc = parseInt(use.ozonCap) || 0;
    const ojPct = of ? (of / (parseInt(use.totalFact) || 1) * 100).toFixed(1) : "-";

    const tp = parseInt(use.totalPlan) || 0;
    const tf = parseInt(use.totalFact) || 0;
    const td = tf - tp;

    totPlan += tp;
    totFact += tf;

    html += `
      <tr>
        <td style="text-align:left">${obj}</td>
        <td>${sp}</td><td>${sf}</td><td class="${sd >= 0 ? 'positive' : 'negative'}">${sd}</td>
        <td>${op}</td><td>${of}</td><td>${oc}</td><td>${ojPct}%</td>
        <td>${use.rv || "-"}</td><td>${use.cmd || "-"}</td>
        <td>${tp}</td><td>${tf}</td><td class="${td >= 0 ? 'positive' : 'negative'}">${td}</td>
        <td>${use.prod || "-"}</td>
        <td>${use.ot || "-"}</td><td>${use.bl || "-"}</td><td>${use.nn || "-"}</td>
        <td style="max-width:120px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${use.comment}</td>
      </tr>
    `;
  });

  html += `
    </tbody>
  </table>
  <div class="summary-total">üìä –ò–¢–û–ì–û: –ø–ª–∞–Ω ${totPlan}, —Ñ–∞–∫—Ç ${totFact}, Œî ${totFact - totPlan}</div>
  `;

  tbl.innerHTML = html;
}
/*****************************************************************
9. –°–¢–ê–†–¢
*****************************************************************/
window.onload = () => {
  renderObjects();
  renderCalendar();
  renderSumCalendar();
};
// –î–æ–±–∞–≤–ª–µ–Ω —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ª–∏ OJ%
document.getElementById("inputs").insertAdjacentHTML("afterend", '<div id="ojPct" style="margin-top: 10px;"></div>');
</script>
</body>
</html>